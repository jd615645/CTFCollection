<p>OMG, I forgot to pierce my haggisâ€™ sheep stomach before cooking it, so it exploded all over my kitchen. Please help me clean up!</p><p>(Fun fact: <a target="_blank" rel="nofollow" href="https://2.bp.blogspot.com/-xQ7-nAK4a-M/UwtnK0JMKYI/AAAAAAAABPo/SE3FsPeQ2ks/s1600/FREE+TO+USE+-+HAGGIS+HURLING1.jpg">Haggis hurling</a> is a thing.)</p><p><code>nc 104.198.243.170 2501</code> <br></p><p>~~~</p><p>#!/usr/bin/env python3</p><p>import os, binascii, struct</p><p>from Crypto.Cipher import AES</p><p><br></p><p>pad = lambda m: m + bytes([16 - len(m) % 16] * (16 - len(m) % 16))</p><p>def haggis(m):</p><p>    crypt0r = AES.new(bytes(0x10), AES.MODE_CBC, bytes(0x10))</p><p>    return crypt0r.encrypt(len(m).to_bytes(0x10, 'big') + pad(m))[-0x10:]</p><p><br></p><p>target = os.urandom(0x10)</p><p>print(binascii.hexlify(target).decode())</p><p><br></p><p>msg = binascii.unhexlify(input())</p><p><br></p><p>if msg.startswith(b'I solemnly swear that I am up to no good.\0') </p><p>        and haggis(msg) == target:</p><p>    print(open('flag.txt', 'r').read().strip())</p><p>~~~</p>
